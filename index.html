<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portofolio Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Menggunakan font Fira Code untuk tampilan monospaced khas terminal */
        body {
            font-family: 'Fira Code', monospace;
        }
        /* Kustomisasi scrollbar agar sesuai tema */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a4a4a;
            border-radius: 4px;
        }
        html.light ::-webkit-scrollbar-track {
            background: #f0f0f0;
        }
        html.light ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
        }
        /* Menghilangkan panah pada input number (jika ada) */
        input[type="text"] {
            caret-color: #4ade80; /* Warna kursor input */
        }
        html.light input[type="text"] {
            caret-color: #16a34a;
        }
        /* Efek kursor berkedip */
        .blinking-cursor {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            from, to {
                color: transparent;
            }
            50% {
                color: inherit;
            }
        }
        /* Sembunyikan kursor vertikal dan teks default dari input field */
        input[type="text"] {
            caret-color: transparent;
            color: transparent;
        }
        /* Memastikan background tetap penuh saat fullscreen */
        :fullscreen {
            background-color: transparent;
        }
    </style>
    <script>
        // Konfigurasi Tailwind CSS untuk mode gelap
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'fira-code': ['Fira Code', 'monospace'],
                    },
                    colors: {
                        'dark-bg': '#1a1b26',
                        'dark-fg': '#a9b1d6',
                        'dark-border': '#414868',
                        'dark-green': '#9ece6a',
                        'dark-blue': '#7aa2f7',
                        'dark-cyan': '#7dcfff',
                        'dark-red': '#f7768e',
                        'light-bg': '#fdfdfd',
                        'light-fg': '#343434',
                        'light-border': '#dcdcdc',
                        'light-green': '#2e9335',
                        'light-blue': '#2e5fdc',
                        'light-cyan': '#2e89a0',
                        'light-red': '#c82a2a',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-light-bg dark:bg-dark-bg text-light-fg dark:text-dark-fg transition-colors duration-300" oncontextmenu="return false;">

    <div id="terminal" class="p-2 sm:p-4 h-screen w-full flex flex-col">
        <!-- Header Jendela Terminal -->
        <div class="bg-gray-200 dark:bg-[#282a36] rounded-t-lg p-2 flex items-center gap-2 shadow-md">
            <div class="w-3.5 h-3.5 bg-red-500 rounded-full"></div>
            <div class="w-3.5 h-3.5 bg-yellow-500 rounded-full"></div>
            <div class="w-3.5 h-3.5 bg-green-500 rounded-full"></div>
            <div class="flex-grow text-center text-sm text-gray-600 dark:text-gray-400 overflow-hidden whitespace-nowrap text-ellipsis px-2">
                nmwafa@portfolio — bash
            </div>
            
            <div class="flex items-center gap-3">
                <!-- Tombol Fullscreen -->
                <button id="fullscreen-toggle" class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white transition-colors">
                    <!-- Icon Expand -->
                    <svg id="fs-icon-expand" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                    </svg>
                    <!-- Icon Compress (Hidden by default) -->
                    <svg id="fs-icon-compress" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4l5 5m11-5l-5 5m-11 11l5-5m11 5l-5-5M9 4v5H4m11-5v5h5M9 20v-5H4m11 5v-5h5"></path>
                    </svg>
                </button>

                <!-- Tombol Light/Dark Mode -->
                <button id="theme-toggle" class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white transition-colors">
                    <svg id="theme-icon-dark" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-icon-light" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 8.486a1 1 0 011.414 0l.707.707a1 1 0 01-1.414 1.414l-.707-.707a1 1 0 010-1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"></path></svg>
                </button>
            </div>
        </div>

        <!-- Konten Terminal -->
        <div id="terminal-body" class="w-full flex-grow bg-white dark:bg-dark-bg border-x-2 border-b-2 border-light-border dark:border-dark-border rounded-b-lg p-4 overflow-y-auto text-sm sm:text-base">
            <div id="output"></div>
            <div class="flex items-center">
                <div class="flex-shrink-0 mr-2">
                    <span class="text-light-green dark:text-dark-green">nmwafa@portfolio</span><span class="text-light-fg dark:text-dark-fg">:</span><span class="text-light-blue dark:text-dark-blue">~</span><span class="text-light-fg dark:text-dark-fg">$</span>
                </div>
                <!-- Container untuk input dan overlay visualnya -->
                <div class="relative flex-grow" onclick="commandInput.focus()">
                    <!-- Input field yang sebenarnya, teks dan kursornya transparan -->
                    <input type="text" id="command-input" class="w-full bg-transparent border-none outline-none" autofocus autocomplete="off">
                    <!-- Overlay visual untuk menampilkan teks dan kursor kustom -->
                    <div class="absolute inset-0 flex items-center pointer-events-none">
                        <span id="input-text-display" class="whitespace-pre"></span>
                        <span id="fake-cursor" class="blinking-cursor">_</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const terminalBody = document.getElementById('terminal-body');
        const output = document.getElementById('output');
        const commandInput = document.getElementById('command-input');
        const themeToggle = document.getElementById('theme-toggle');
        const themeIconDark = document.getElementById('theme-icon-dark');
        const themeIconLight = document.getElementById('theme-icon-light');
        const fakeCursor = document.getElementById('fake-cursor');
        const inputTextDisplay = document.getElementById('input-text-display');
        
        // Unsur baru untuk Fullscreen
        const fullscreenToggle = document.getElementById('fullscreen-toggle');
        const fsIconExpand = document.getElementById('fs-icon-expand');
        const fsIconCompress = document.getElementById('fs-icon-compress');

        // --- Data Mock untuk Blog dan Proyek ---
        const blogPosts = {
            '1': { title: 'Lagi browsing ketemu CAPTCHA? Awas palsu!!!', url: 'https://medium.com/@nmwafa/lagi-browsing-ketemu-captcha-awas-palsu-c90586326b86' },
            '2': { title: 'Kenalan dengan GNS3', url: 'https://medium.com/@nmwafa/kenalan-dengan-gns3-29c227e07d0d' },
            '3': { title: 'Hardening Web Server di Linux Ubuntu', url: 'https://medium.com/@nmwafa/hardening-web-server-di-linux-ubuntu-66c7803d3d7e' },
            '4': { title: 'Apa itu Fork bomb?', url: 'https://nmwafa.medium.com/apa-itu-fork-bomb-27a2a4d0ffe9' },
            '5': { title: 'HTB Skills Assessment — SQL Injection Fundamentals', url: 'https://medium.com/@nmwafa/htb-skills-assessment-sql-injection-fundamentals-4584dc7568a5' },
            '6': { title: 'Mengenal kerentanan desinkronisasi HTTP', url: 'https://nmwafa.medium.com/mengenal-kerentanan-desinkronisasi-http-7d59abef382b' }
        };

        const projects = [
            { name: 'Recon & Pillage', description: 'Skrip automasi pencarian subdomain, deteksi teknologi, dan mengkategorikan berdasarkan status kode, url dan teknologi.', url: 'https://github.com/nmwafa/recon-pillage' }
        ];

        const certUrl = 'https://drive.google.com/drive/folders/1LydeHP-hpuWUZEipSZV-B0h8dJloc89W?usp=sharing';

        // --- Fungsi-fungsi Perintah ---
        const commands = {
            help: () => {
                return `
                    <p class="mb-2">Perintah yang tersedia:</p>
                    <ul class="list-inside list-disc">
                        <li><span class="text-light-green dark:text-dark-green">about</span>        - Tampilkan informasi tentang saya.</li>
                        <li><span class="text-light-green dark:text-dark-green">projects</span>     - Lihat daftar proyek yang pernah saya buat.</li>
                        <li><span class="text-light-green dark:text-dark-green">blog</span>         - Akses artikel blog. Gunakan 'blog list' atau 'blog read [id]'.</li>
                        <li><span class="text-light-green dark:text-dark-green">cert</span>         - Lihat sertifikat dan surat apresiasi.</li>
                        <li><span class="text-light-green dark:text-dark-green">contact</span>      - Tampilkan informasi kontak.</li>
                        <li><span class="text-light-green dark:text-dark-green">clear</span>        - Bersihkan layar terminal.</li>
                        <li><span class="text-light-green dark:text-dark-green">welcome</span>      - Tampilkan kembali pesan selamat datang.</li>
                    </ul>
                `;
            },
            about: () => {
                return `
                    <p>Hai! Saya seorang penggemar teknologi yang memulai perjalanan IT di akhir 2022.</p>
                    <p>Saya mempelajari berbagai hal terkait Pemrograman dan Jaringan. Pada pertengahan 2023, saya mulai mempelajari tentang Keamanan siber.</p>
                    <p>Saat ini, saya fokus pada keamanan aplikasi web dan terus menjelajahi cara-cara baru untuk meningkatkan keterampilan saya dan tetap update dengan tren terbaru di bidang ini.</p>
                    <p>Kadang-kadang saya mengasah kemampuan dengan 'berburu serangga' dan berkontribusi terhadap keamanan sistem untuk organisasi pendidikan dan lainnya.</p>
                `;
            },
            projects: () => {
                let projectList = '<p class="mb-2">Berikut adalah proyek yagng saya buat:</p>';
                projects.forEach(p => {
                    projectList += `
                        <div class="mb-2">
                            <p class="text-light-cyan dark:text-dark-cyan font-bold">${p.name}</p>
                            <p class="pl-4"> ${p.description} <a href="${p.url}" target="_blank" class="underline">Lihat Proyek</a></p>
                        </div>
                    `;
                });
                return projectList;
            },
            blog: (args) => {
                if (args.length === 0 || args[0] === 'list') {
                    let postList = '<p class="mb-2">Daftar artikel blog. Gunakan perintah \'blog read [id]\' untuk membaca (ex: blog read 1):</p>';
                    Object.entries(blogPosts).forEach(([id, post]) => {
                        postList += `<p><span class="text-light-cyan dark:text-dark-cyan">[${id}]</span> ${post.title} </p>`;
                    });
                    return postList;
                }
                if (args[0] === 'read' && args[1]) {
                    const post = blogPosts[args[1]];
                    if (post) {
                        window.open(post.url, '_blank');
                        return `<p>Membuka artikel "${post.title}" di tab baru...</p>`;
                    }
                    return `<p class="text-light-red dark:text-dark-red">Error: Post dengan ID '${args[1]}' tidak ditemukan.</p>`;
                }
                return `<p class="text-light-red dark:text-dark-red">Error: Perintah blog tidak valid. Gunakan 'blog list' atau 'blog read [id]'.</p>`;
            },
            cert: () => {
                window.open(certUrl, '_blank');
                return `<p>Membuka halaman di tab baru...</p>`;
            },
            contact: () => {
                return `
                    <p>Mari terhubung :)</p>
                    <ul>
                        <li>~ Email: <a href="mailto:nmw.exit045@passinbox.com" class="underline text-light-blue dark:text-dark-blue">nmw.exit045@passinbox.com</a></li>
                        <li>~ GitHub: <a href="https://github.com/nmwafa" target="_blank" class="underline text-light-blue dark:text-dark-blue">nmwafa</a></li>
                        <li>~ LinkedIn: <a href="https://www.linkedin.com/in/nmwafa" target="_blank" class="underline text-light-blue dark:text-dark-blue">nmwafa</a></li>
                    </ul>
                `;
            },
            clear: () => {
                output.innerHTML = '';
                return '';
            },
            welcome: () => {
                return getWelcomeMessage();
            }
        };

        // --- Logika Terminal ---
        commandInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !commandInput.disabled) {
                commandInput.disabled = true;
                const fullCommand = commandInput.value.trim();
                if (fullCommand) {
                    const [command, ...args] = fullCommand.split(' ');
                                        
                    const promptLine = document.createElement('div');
                    promptLine.innerHTML = `
                        <div class="flex">
                            <div class="flex-shrink-0 mr-2">
                                <span class="text-light-green dark:text-dark-green">nmwafa@portfolio</span><span class="text-light-fg dark:text-dark-fg">:</span><span class="text-light-blue dark:text-dark-blue">~</span><span class="text-light-fg dark:text-dark-fg">$</span>
                            </div>
                            <div class="flex-grow break-all">${fullCommand}</div>
                        </div>`;
                    output.appendChild(promptLine);
                    commandInput.value = '';
                    inputTextDisplay.textContent = ''; // Hapus juga teks visual

                    const resultDiv = document.createElement('div');
                    output.appendChild(resultDiv);

                    if (commands[command]) {
                        const result = commands[command](args);
                        resultDiv.innerHTML = result;
                    } else {
                        resultDiv.innerHTML = `<p class="text-light-red dark:text-dark-red">Error: Perintah tidak ditemukan: ${command}. Ketik 'help' untuk daftar perintah.</p>`;
                    }
                                        
                    terminalBody.scrollTop = terminalBody.scrollHeight;
                }
                commandInput.disabled = false;
                commandInput.focus();
            }
        });

        // Sinkronkan teks dari input yang tersembunyi ke tampilan visual
        commandInput.addEventListener('input', () => {
            if (inputTextDisplay) {
                inputTextDisplay.textContent = commandInput.value;
            }
        });

        // --- Tema ---
        const setTheme = (theme) => {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                themeIconLight.classList.remove('hidden');
                themeIconDark.classList.add('hidden');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                themeIconDark.classList.remove('hidden');
                themeIconLight.classList.add('hidden');
                localStorage.setItem('theme', 'light');
            }
        };

        themeToggle.addEventListener('click', () => {
            const currentTheme = localStorage.getItem('theme') || 'dark';
            setTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });

        // --- Logika Fullscreen (Cross-Browser) ---
        function toggleFullscreen() {
            if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) {
                // Masuk Fullscreen
                const elem = document.documentElement;
                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.webkitRequestFullscreen) {
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) {
                    elem.msRequestFullscreen();
                } else if (elem.mozRequestFullScreen) {
                    elem.mozRequestFullScreen();
                }
            } else {
                // Keluar Fullscreen
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                }
            }
        }

        fullscreenToggle.addEventListener('click', toggleFullscreen);

        // Update icon saat status fullscreen berubah (termasuk jika user tekan ESC)
        function updateFullscreenIcons() {
            const isFullscreen = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
            if (isFullscreen) {
                fsIconExpand.classList.add('hidden');
                fsIconCompress.classList.remove('hidden');
            } else {
                fsIconExpand.classList.remove('hidden');
                fsIconCompress.classList.add('hidden');
            }
        }

        document.addEventListener('fullscreenchange', updateFullscreenIcons);
        document.addEventListener('webkitfullscreenchange', updateFullscreenIcons);
        document.addEventListener('mozfullscreenchange', updateFullscreenIcons);
        document.addEventListener('MSFullscreenChange', updateFullscreenIcons);

        // --- Inisialisasi ---
        function getWelcomeMessage() {
            return `
                <p class="text-2xl font-bold text-light-green dark:text-dark-green mb-4">Selamat Datang di Portofolio Terminal!</p>
                <p>Ini adalah portofolio interaktif dengan style CLI.</p>
                <p>Ketik <span class="text-light-cyan dark:text-dark-cyan">'help'</span> untuk melihat daftar perintah yang tersedia.</p>
                <br>
            `;
        }
                
        function initialize() {
            const preferredTheme = localStorage.getItem('theme');
            setTheme(preferredTheme || 'dark');
            output.innerHTML = getWelcomeMessage();
            // Saat terminal diklik di mana saja, fokuskan ke input
            terminalBody.addEventListener('click', (e) => {
                // Hindari re-focus jika yang diklik adalah link
                if (e.target.tagName !== 'A') {
                    commandInput.focus();
                }
            });
            commandInput.focus();
        }
        initialize();
    </script>

    <!-- Block Inspeksi (Ctrl+U, F12, Right Click) -->
    <script>
        document.addEventListener('keydown', function(e) {
            const isControlOrCommand = e.ctrlKey || e.metaKey;
            const key = e.key ? e.key.toUpperCase() : '';
            if (e.keyCode === 123 || (isControlOrCommand && key === 'U') || (isControlOrCommand && e.shiftKey && (key === 'I' || key === 'J' || key === 'C'))) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>
